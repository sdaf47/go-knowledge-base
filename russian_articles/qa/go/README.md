# Вопросы по Golang

## Какие в Go есть инструменты для многопоточности?

### Пакет sync
**WaitGroup** — ждет завершения коллекции из одной или нескольких goroutine. 
Количество ожидаемых горутин определяется счетчиком, который заполняется с помощью метода Add в основном потоке(goroutine).
Затем в каждой из goroutine вызывается метод Done, сообщающий о завершении выполнения потока. 
Метод Wait будет блокировать выполнение основоного потока до тех пор, пока все горуты не будут выполнены.

**Mutex** — двоичный семафор, защищающий объект от изменений сразу из нескольких потоков (состояния гонки).
Иными словами, mutex не позволяет нескольким потокам получить доступ к объекту одноврменно.

```go
package main

import (
	"fmt"
	"sync"
)

func main() {
	var mutex = &sync.Mutex{}
	var wg = sync.WaitGroup{}

	n := 0
	for i := 0; i < 1000; i++ {
		wg.Add(1)
		go func(num *int) {
		  // с помощью отложенной функции сообщаем, что поток закончил выполнение
			defer wg.Done()
			// переводим mutext в неотмеченное состояние, блокируя доступ для других потоков 
			mutex.Lock()
			// изменяем значение переменно n, переданной по ссылке
			*num++ 
			// переводим mutext в отмеченное состояние, освобождая его для других потоков
			mutex.Unlock() 
		}(&n)
	}
	// блокирем выполнение основого потока до момента, как 1000 потоков сообщат о прекращении работы
	wg.Wait() 

	fmt.Println(n) // 1000
}
```


### Паттерны параллелизма в Golang